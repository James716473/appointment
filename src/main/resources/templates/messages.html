<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:inline="javascript">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/js/user_functions.js" defer></script>
    <title>Messages</title>
    <style>
        .left {
            text-align: left;
        }

        .right {
            text-align: right;
        }
    </style>
</head>
<body>
    

    <label for="recipient">To: </label>
    <div id="recipient-div" th:data-role="|${role}|">
        <div th:each="recipient : ${role == 'doctor' ? users : doctors}">
            <input type="radio" id="recipient-${recipient.id}" name="recipient" 
                th:value="${role == 'user' ? recipient.doctor_id : recipient.user_id}" 
                th:text="|${recipient.first_name} ${recipient.last_name}|"
                th:onchange="|filterMessages(${id})|" />
            <label for="recipient-${recipient.id}" th:text="|${recipient.first_name} ${recipient.last_name}|"></label><br>
        </div>
    </div>

    <br><br>
    
    



    <div th:if="${messages.size() > 0}">
        <ul id="messages-list">
            <li th:each="message : ${messages}" style="display: none;" th:class="${(message.message_type == 'u-d' && role == 'user') || (role == 'doctor' && message.message_type == 'd-u') ? 'right' : 'left'}" th:attr="data-sender-id=${message.sender_id}, data-receiver-id=${message.receiver_id}, data-message-type=${message.message_type}" th:text="${message.message}"></li>
        </ul>
    </div>
    <div th:if="${messages.size() == 0}"> 
        <p>No messages available.</p>
    </div>

    
    <div>
        <label  for="message"></label>
        <input  type="text" id="message" name="message" placeholder="Write your message here...">
        <input  type="button" value="Send" id="send__button" th:data-role="${role}" th:attr="onclick=|send_message(event, ${id})|">    
    </div>
   <br><br>
</body>
</html>